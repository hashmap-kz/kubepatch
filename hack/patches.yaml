- target:
    kind: Deployment
    name: myapp
  patches:
    - op: replace
      path: /spec/replicas
      value: 3
      when: ENV == "prod"

    - op: replace
      path: /spec/template/spec/containers/0/image
      value: nginx:1.26
      when: REGION == "eu"

    - op: replace
      path: /spec/template/spec/containers/0/resources
      value:
        limits:
          cpu: "500m"
          memory: "256Mi"
        requests:
          cpu: "250m"
          memory: "128Mi"
      when: ENV != "dev" && REGION == "eu"
